{"ast":null,"code":"\"use strict\";\n\nvar _toConsumableArray = require(\"/Users/taykim/Desktop/cs98/project-22f-zk-vote/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toConsumableArray.js\").default;\nvar _taggedTemplateLiteral = require(\"/Users/taykim/Desktop/cs98/project-22f-zk-vote/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js\").default;\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.extendSubschemaMode = exports.extendSubschemaData = exports.getSubschema = void 0;\nvar codegen_1 = require(\"../codegen\");\nvar util_1 = require(\"../util\");\nfunction getSubschema(it, _ref) {\n  var keyword = _ref.keyword,\n    schemaProp = _ref.schemaProp,\n    schema = _ref.schema,\n    schemaPath = _ref.schemaPath,\n    errSchemaPath = _ref.errSchemaPath,\n    topSchemaRef = _ref.topSchemaRef;\n  if (keyword !== undefined && schema !== undefined) {\n    throw new Error('both \"keyword\" and \"schema\" passed, only one allowed');\n  }\n  if (keyword !== undefined) {\n    var sch = it.schema[keyword];\n    return schemaProp === undefined ? {\n      schema: sch,\n      schemaPath: (0, codegen_1._)(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\", \"\", \"\"])), it.schemaPath, (0, codegen_1.getProperty)(keyword)),\n      errSchemaPath: \"\".concat(it.errSchemaPath, \"/\").concat(keyword)\n    } : {\n      schema: sch[schemaProp],\n      schemaPath: (0, codegen_1._)(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\", \"\", \"\", \"\"])), it.schemaPath, (0, codegen_1.getProperty)(keyword), (0, codegen_1.getProperty)(schemaProp)),\n      errSchemaPath: \"\".concat(it.errSchemaPath, \"/\").concat(keyword, \"/\").concat((0, util_1.escapeFragment)(schemaProp))\n    };\n  }\n  if (schema !== undefined) {\n    if (schemaPath === undefined || errSchemaPath === undefined || topSchemaRef === undefined) {\n      throw new Error('\"schemaPath\", \"errSchemaPath\" and \"topSchemaRef\" are required with \"schema\"');\n    }\n    return {\n      schema: schema,\n      schemaPath: schemaPath,\n      topSchemaRef: topSchemaRef,\n      errSchemaPath: errSchemaPath\n    };\n  }\n  throw new Error('either \"keyword\" or \"schema\" must be passed');\n}\nexports.getSubschema = getSubschema;\nfunction extendSubschemaData(subschema, it, _ref2) {\n  var dataProp = _ref2.dataProp,\n    dpType = _ref2.dataPropType,\n    data = _ref2.data,\n    dataTypes = _ref2.dataTypes,\n    propertyName = _ref2.propertyName;\n  if (data !== undefined && dataProp !== undefined) {\n    throw new Error('both \"data\" and \"dataProp\" passed, only one allowed');\n  }\n  var gen = it.gen;\n  if (dataProp !== undefined) {\n    var errorPath = it.errorPath,\n      dataPathArr = it.dataPathArr,\n      opts = it.opts;\n    var nextData = gen.let(\"data\", (0, codegen_1._)(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\", \"\", \"\"])), it.data, (0, codegen_1.getProperty)(dataProp)), true);\n    dataContextProps(nextData);\n    subschema.errorPath = (0, codegen_1.str)(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\", \"\", \"\"])), errorPath, (0, util_1.getErrorPath)(dataProp, dpType, opts.jsPropertySyntax));\n    subschema.parentDataProperty = (0, codegen_1._)(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\", \"\"])), dataProp);\n    subschema.dataPathArr = [].concat(_toConsumableArray(dataPathArr), [subschema.parentDataProperty]);\n  }\n  if (data !== undefined) {\n    var _nextData2 = data instanceof codegen_1.Name ? data : gen.let(\"data\", data, true); // replaceable if used once?\n    dataContextProps(_nextData2);\n    if (propertyName !== undefined) subschema.propertyName = propertyName;\n    // TODO something is possibly wrong here with not changing parentDataProperty and not appending dataPathArr\n  }\n\n  if (dataTypes) subschema.dataTypes = dataTypes;\n  function dataContextProps(_nextData) {\n    subschema.data = _nextData;\n    subschema.dataLevel = it.dataLevel + 1;\n    subschema.dataTypes = [];\n    it.definedProperties = new Set();\n    subschema.parentData = it.data;\n    subschema.dataNames = [].concat(_toConsumableArray(it.dataNames), [_nextData]);\n  }\n}\nexports.extendSubschemaData = extendSubschemaData;\nfunction extendSubschemaMode(subschema, _ref3) {\n  var jtdDiscriminator = _ref3.jtdDiscriminator,\n    jtdMetadata = _ref3.jtdMetadata,\n    compositeRule = _ref3.compositeRule,\n    createErrors = _ref3.createErrors,\n    allErrors = _ref3.allErrors;\n  if (compositeRule !== undefined) subschema.compositeRule = compositeRule;\n  if (createErrors !== undefined) subschema.createErrors = createErrors;\n  if (allErrors !== undefined) subschema.allErrors = allErrors;\n  subschema.jtdDiscriminator = jtdDiscriminator; // not inherited\n  subschema.jtdMetadata = jtdMetadata; // not inherited\n}\n\nexports.extendSubschemaMode = extendSubschemaMode;","map":{"version":3,"sources":["../../../lib/compile/validate/subschema.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.extendSubschemaMode = exports.extendSubschemaData = exports.getSubschema = void 0;\nconst codegen_1 = require(\"../codegen\");\nconst util_1 = require(\"../util\");\nfunction getSubschema(it, { keyword, schemaProp, schema, schemaPath, errSchemaPath, topSchemaRef }) {\n    if (keyword !== undefined && schema !== undefined) {\n        throw new Error('both \"keyword\" and \"schema\" passed, only one allowed');\n    }\n    if (keyword !== undefined) {\n        const sch = it.schema[keyword];\n        return schemaProp === undefined\n            ? {\n                schema: sch,\n                schemaPath: (0, codegen_1._) `${it.schemaPath}${(0, codegen_1.getProperty)(keyword)}`,\n                errSchemaPath: `${it.errSchemaPath}/${keyword}`,\n            }\n            : {\n                schema: sch[schemaProp],\n                schemaPath: (0, codegen_1._) `${it.schemaPath}${(0, codegen_1.getProperty)(keyword)}${(0, codegen_1.getProperty)(schemaProp)}`,\n                errSchemaPath: `${it.errSchemaPath}/${keyword}/${(0, util_1.escapeFragment)(schemaProp)}`,\n            };\n    }\n    if (schema !== undefined) {\n        if (schemaPath === undefined || errSchemaPath === undefined || topSchemaRef === undefined) {\n            throw new Error('\"schemaPath\", \"errSchemaPath\" and \"topSchemaRef\" are required with \"schema\"');\n        }\n        return {\n            schema,\n            schemaPath,\n            topSchemaRef,\n            errSchemaPath,\n        };\n    }\n    throw new Error('either \"keyword\" or \"schema\" must be passed');\n}\nexports.getSubschema = getSubschema;\nfunction extendSubschemaData(subschema, it, { dataProp, dataPropType: dpType, data, dataTypes, propertyName }) {\n    if (data !== undefined && dataProp !== undefined) {\n        throw new Error('both \"data\" and \"dataProp\" passed, only one allowed');\n    }\n    const { gen } = it;\n    if (dataProp !== undefined) {\n        const { errorPath, dataPathArr, opts } = it;\n        const nextData = gen.let(\"data\", (0, codegen_1._) `${it.data}${(0, codegen_1.getProperty)(dataProp)}`, true);\n        dataContextProps(nextData);\n        subschema.errorPath = (0, codegen_1.str) `${errorPath}${(0, util_1.getErrorPath)(dataProp, dpType, opts.jsPropertySyntax)}`;\n        subschema.parentDataProperty = (0, codegen_1._) `${dataProp}`;\n        subschema.dataPathArr = [...dataPathArr, subschema.parentDataProperty];\n    }\n    if (data !== undefined) {\n        const nextData = data instanceof codegen_1.Name ? data : gen.let(\"data\", data, true); // replaceable if used once?\n        dataContextProps(nextData);\n        if (propertyName !== undefined)\n            subschema.propertyName = propertyName;\n        // TODO something is possibly wrong here with not changing parentDataProperty and not appending dataPathArr\n    }\n    if (dataTypes)\n        subschema.dataTypes = dataTypes;\n    function dataContextProps(_nextData) {\n        subschema.data = _nextData;\n        subschema.dataLevel = it.dataLevel + 1;\n        subschema.dataTypes = [];\n        it.definedProperties = new Set();\n        subschema.parentData = it.data;\n        subschema.dataNames = [...it.dataNames, _nextData];\n    }\n}\nexports.extendSubschemaData = extendSubschemaData;\nfunction extendSubschemaMode(subschema, { jtdDiscriminator, jtdMetadata, compositeRule, createErrors, allErrors }) {\n    if (compositeRule !== undefined)\n        subschema.compositeRule = compositeRule;\n    if (createErrors !== undefined)\n        subschema.createErrors = createErrors;\n    if (allErrors !== undefined)\n        subschema.allErrors = allErrors;\n    subschema.jtdDiscriminator = jtdDiscriminator; // not inherited\n    subschema.jtdMetadata = jtdMetadata; // not inherited\n}\nexports.extendSubschemaMode = extendSubschemaMode;\n//# sourceMappingURL=subschema.js.map"]},"metadata":{},"sourceType":"script"}